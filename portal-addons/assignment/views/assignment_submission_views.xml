<?xml version="1.0"?>
<odoo>
    <record id="assignment_submission_view_form" model="ir.ui.view">
        <field name="name">assignment_submission.form</field>
        <field name="model">assignment_submission</field>
        <field name="arch" type="xml">
            <form string="Assignment Submission">
                <sheet>
                    <header class="d-flex align-items-center justify-content-start px-0 py-2">
                        <button name="submit_grade" attrs="{'invisible':[('has_graded_all_criteria','=',True),('result','=','not_graded')]}" string="Submit" confirm="Are you sure? You can not re-grade this submission after clicking OK." type="object" class="oe_highlight disabled"/>
                        <button name="submit_grade" attrs="{'invisible':['|',('has_graded_all_criteria','=',False),('result','!=','not_graded')]}" string="Submit" confirm="Are you sure? You can not re-grade this submission after clicking OK." type="object" class="oe_highlight"/>
                        <button name="submit_grade" attrs="{'invisible':[('result','!=','not_graded')]}" context="{'unable_to_review': True}" type="object" class="mx-2 btn-danger oe_highlight" string="Unable To Review" confirm="Are you sure? You can not re-grade this submission after clicking OK."/>
                        <button attrs="{'invisible':[('result','=','not_graded')]}" class="disabled mx-2 btn-danger oe_highlight" string="Unable To Review" />
                    </header>

                    <h3 class="mt-2 mb-2">Genaral Information</h3>
                    <group>
                        <field name="has_graded_all_criteria" invisible="1"/>
                        <group>
                            <field name="student" string="Student" class="border bg-light" write="false"/>
                            <field name="course" string="Course" class="border bg-light" write="false"/>
                            <field name="assignment" string="Assignment" class="border bg-light" write="false"/>
                        </group>
                        <group>
                            <field name="result" string="Result" class="border bg-light" write="false"/>
                            <field name="submission_url" string="Submission URL" class="border bg-light" write="false"/>
                            <field name="submission_note" string="Submission Note" class="border bg-light" />
                            <field name="general_response" string="General Response" class="border bg-light" attrs="{'readonly': [('result', '!=', 'not_graded')]}"/>
                        </group>


                        <h3 class="mt-2 mb-2">Annotation</h3>
                        <field name="annotation" string="Annotation" class="border bg-light" />

                        <!-- để nguyên -->
                        <h3 class="mt-2 mb-2">Criterion Grading</h3>
                        <field attrs="{'readonly':[('result','!=','not_graded')]}" name="criteria_responses" string="Criterion Grading" class="border bg-light">
                            <tree string="Criterion Response" create="false" delete="false" default_order="criteria_group">
                                <field name="criteria_group"/>
                                <field name="number"/>
                                <field name="submission"/>
                                <field name="criterion"/>
                                <field name="feed_back"/>
                                <field name="result"/>
                            </tree>
                        </field>
                    </group>
                </sheet>

                <!-- trace log -->
                <div class="oe_chatter">
                    <field name="activity_ids"/>
                    <field name="message_follower_ids" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="assignment_submission_view_tree" model="ir.ui.view">
        <field name="name">assignment_submission.tree</field>
        <field name="model">assignment_submission</field>
        <field name="arch" type="xml">
            <tree limit="100" string="Assignment Submission Group" edit="false" class="text-center">
                <field name="course" />
                <field name="assignment" />
                <field name="student" />
                <field name="submission_url" widget="url" />
                <field name="result" />
                <field name="submission_note" />
                <field name="general_response" />
            </tree>
        </field>
    </record>

    <record id="assignment_submission_action" model="ir.actions.act_window">
        <field name="name">Assignment Submission</field>
        <field name="res_model">assignment_submission</field>
        <field name="view_mode">tree,form</field>
    </record>
</odoo>
